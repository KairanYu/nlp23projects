
# 基于HanLP的大众点评餐厅评价好坏原因筛选

  
在当今社会，随着互联网在经济和日常生活中的广泛应用，人们在选择餐厅用餐或购物时更倾向于通过在线评价获取信息。比如，在大众点评等网站上查看餐厅的评价已成为一种常见的行为。然而，人们对同一家餐厅的评价可能千差万别，而且评价中不仅包含真实的消费者反馈，也存在刻意刷好评或差评的情况。因此，我的项目旨在借助自然语言处理的技术，从海量评价中提炼出餐厅获得好评和差评的主要原因，帮助消费者更方便直观地选择餐厅消费。

# HanLP简介

本项目主要使用的是HanLP工具包来处理自然语言，HanLP是一个面向生产环境的多语种自然语言处理工具包，基于PyTorch和TensorFlow 2.x双引擎，目标是普及落地最前沿的NLP技术。HanLP具备功能完善、精度准确、性能高效、语料时新、架构清晰、可自定义的特点。


## 选择使用HanLP的原因
- 大部分大语言模型最初主要做的都是英文自然语言处理，但HanLP最初做的是中文分词，更适合用于本项目场景，处理中文点评网站上的评价文本。
- HanLP有轻量级RESTful API，不需要配GPU环境，申请了密钥之后可以直接在本机上运行，适合本项目的小样本场景。


# 代码功能介绍

本项目主要分成以下四个主要部分，分别为：爬虫获取评价数据、数据清洗与预处理、使用HanLP获取每条评论主要内容、好评与差评关键词聚合提取及可视化。

## 一、爬虫获取数据

从大众点评网站上将想要分析的餐厅的评价网页全都爬下来，本项目选择了人大周边的两家餐厅：品质伊骊(人大创始店)和麦当劳(苏州桥店)。每家餐厅获取最新的10页评论，存入txt里，方便后续处理。

## 二、数据清洗与预处理

将爬虫得到的数据评论页面进行数据清洗，得到清洗后的评论文本、环境打分、口味打分、服务打分，将评论文本中由于爬虫得到的特殊字符等清洗干净。
将文本长度限制在1000字以内（后续使用HanLP进行情绪打分时的字数上限）。
对环境、口味、服务分数取平均值作为该评论的average score。
根据average score为每条评论定性，阈值可以根据实际情况进行调整，比如认为分数低于4分的评论是差评，大于4是好评，为每条评论进行标签处理。

## 三、使用HanLP获取每条评论主要信息

最初，我直接使用HanLP的keyphrase_extraction函数对每条评论文本进行关键词提取，想作为好评和差评的原因。经助教师姐提示后发现关键词和给好评或差评的原因并不一致。有的消费者可能对环境和口味很满意，但对服务不满意，最终是一条差评，他的评价就可能包含一部分夸赞环境和口味的内容，和一部分关于服务差的内容。我们可能只想要提取出给服务差评的原因，但直接提取关键词会获得很多不相关的关于环境合口味的关键词内容，并不能反映消费者给好评/差评的原因。
经过修改后，首先对评价文本逐句切割，分别进行情绪打分，对于好评筛选出得分最积极的句子，差评筛选出得分最消极的句子，且保证句子长度不短于10个字（包含一定内容），称这个句子为这个评价的核心句子，再对核心句子进行关键词提取，提取时筛选一下关键词与句子的相关度，比如限制相关度至少高于0.3才认为是有效关键词。


## 四、关键词聚合提取及可视化

在获取了核心句子关键词后，对出现较为频繁的关键词进行提取，作为好评和差评的原因，并绘制词云图。
下面是打印出的较频繁的关键词截图：
![输入图片说明](/imgs/2023-12-16/z9wqyFHQvIrfiwl1.png)
![麦当劳未筛选核心句子的好评词云图](/imgs/2023-12-16/Zjcx0UjTEPP4hOxt.png)
麦当劳未筛选核心句子的好评词云图↑
![麦当劳筛选核心句子后的好评词云图](/imgs/2023-12-16/IPbOInEDUvUPP6Eh.png)
麦当劳筛选核心句子后的好评词云图↑
![输入图片说明](/imgs/2023-12-16/5aA2zDbu2xmMNkOI.png)
品质伊骊未筛选核心句子的差评词云图↑
![输入图片说明](/imgs/2023-12-16/EivYZN7dvYgWcfzD.png)
品质伊骊筛选核心句子后的差评词云图↑

# 对应py文件功能
- clawer.py 用于爬取大众点评网站上的评论并存入txt文档中
- read_clawer.py 用于清洗爬虫得到的数据
- simple_keywords.py 直接对评论进行关键词提取
- sentence_by_sentence.py 按照句子分割评论，并筛选出核心句子
- get_keywords.py 获取核心句子的关键词
- most_frequent_words_wordcloud.py 获取最频繁的关键词并绘制词云图





